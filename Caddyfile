:{$PORT} {

    # backend - preserve /api prefix
    handle /api/* {
        reverse_proxy {
            dynamic a {
                name {$BACKEND_DOMAIN}
                port {$BACKEND_PORT}
                refresh 1s
            }
            header_up Host {upstream_hostport}
        }
    }

    # frontend - everything else
    reverse_proxy {
        dynamic a {
            name {$FRONTEND_DOMAIN}
            port {$FRONTEND_PORT}
            refresh 1s
        }
        header_up Host {upstream_hostport}
    }
}
